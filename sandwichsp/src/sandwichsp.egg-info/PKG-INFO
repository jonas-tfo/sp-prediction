Metadata-Version: 2.4
Name: sandwichsp
Version: 0.1.0
Summary: Signal peptide prediction using deep learning
Author: Jonas
License: MIT
Project-URL: Homepage, https://github.com/jonas-tfo/sp-prediction
Project-URL: Repository, https://github.com/jonas-tfo/sp-prediction
Project-URL: Issues, https://github.com/jonas-tfo/sp-prediction/issues
Keywords: bioinformatics,signal-peptide,deep-learning,protein
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Science/Research
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Scientific/Engineering :: Bio-Informatics
Requires-Python: >=3.9
Description-Content-Type: text/markdown
Requires-Dist: torch>=1.13.0
Requires-Dist: pytorch-crf>=0.7.2
Requires-Dist: transformers>=4.30.0
Requires-Dist: numpy>=1.21.0
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0.0; extra == "dev"

# SandwichSP

Signal peptide prediction using deep learning. SandwichSP uses a CNN-LSTM-CRF architecture with ProtT5 embeddings to predict signal peptides and their cleavage sites in protein sequences.

## Installation

```bash
pip install git+https://github.com/jonas-tfo/sp-prediction.git#subdirectory=sandwichsp
```

## Quick Start

```python
from sandwichsp import SandwichSP

# Initialize (downloads model weights on first use)
model = SandwichSP()

# Predict signal peptide
result = model.predict("MKFLILLFNILCLFPVLAADNHGVPKRSRARASGASQRLLKL")

print(f"SP Type: {result.sp_type}")
print(f"Cleavage Site: {result.cleavage_site}")
print(f"Labels: {result.labels}")
```

Output:
```
SP Type: SP
Cleavage Site: 21
Labels: SSSSSSSSSSSSSSSSSSSSSIIIIIIIIIIIIIIIIIIIII
```

## Batch Prediction

```python
sequences = [
    "MKFLILLFNILCLFPVLAADNHGVPKRSRARASGASQRLLKL",
    "MKTAYIAKQRQISFVKSHFSRQLEERLGLIEVQAPILSRVGD",
]

results = model.predict_batch(sequences)

for result in results:
    print(f"{result.sp_type}: cleavage at {result.cleavage_site}")
```

## Label Meanings

| Label | Description |
|-------|-------------|
| S | Sec/SPI signal peptide |
| T | Tat/SPI signal peptide |
| L | Sec/SPII signal peptide (lipoprotein) |
| I | Cytoplasm (no signal peptide) |
| M | Transmembrane region |
| O | Other/extracellular |

## SP Types

| Type | Description |
|------|-------------|
| SP | Sec signal peptide (most common) |
| TAT | Tat signal peptide (twin-arginine) |
| LIPO | Lipoprotein signal peptide |
| NO_SP | No signal peptide detected |

## API Reference

### `SandwichSP`

```python
SandwichSP(device="auto", weights_path=None)
```

**Parameters:**
- `device`: Device to use (`"cuda"`, `"mps"`, `"cpu"`, or `"auto"`)
- `weights_path`: Path to model weights (downloads automatically if None)

**Methods:**
- `predict(sequence: str) -> PredictionResult`: Predict for a single sequence
- `predict_batch(sequences: list[str]) -> list[PredictionResult]`: Batch prediction

### `PredictionResult`

**Attributes:**
- `sequence`: Input amino acid sequence
- `labels`: Per-residue label string
- `sp_type`: Signal peptide type (`"SP"`, `"TAT"`, `"LIPO"`, `"NO_SP"`)
- `cleavage_site`: Cleavage position (0-indexed) or None

## Requirements

- Python >= 3.9
- PyTorch >= 1.13.0
- Transformers >= 4.30.0
- pytorch-crf >= 0.7.2

## Model Architecture

SandwichSP uses a CNN-LSTM-CRF architecture:

1. **Input**: ProtT5-XL-Half embeddings (1024 dimensions)
2. **Conv1D** (kernel=5) with BatchNorm and GELU
3. **Bidirectional LSTM** (2 layers, 512 hidden units)
4. **Parallel Conv1D branches** (kernels 7 and 9)
5. **CRF layer** for sequence-level decoding

## License

MIT License
